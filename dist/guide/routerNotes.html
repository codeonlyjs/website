<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- HTML Meta Tags -->
    <title>CodeOnlyJS </title>
    <meta name="description" content="The front-end Web framework for coders." />
    <!-- Google / Search Engine Tags -->
    <meta itemprop="name" content="CodeOnlyJS " />
    <meta itemprop="description" content="The front-end Web framework for coders" />
    <meta itemprop="image" content="https://codeonlyjs.org/social-card-dark-1200.png" />
    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="https://codeonlyjs.org/" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="CodeOnlyJS " />
    <meta property="og:description" content="The front-end Web framework for coders" />
    <meta property="og:image" content="https://codeonlyjs.org/social-card-dark-1200.png" />
    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="CodeOnlyJS " />
    <meta name="twitter:description" content="The front-end Web framework for coders" />
    <meta name="twitter:image" content="https://codeonlyjs.org/social-card-dark-1200.png" />
    <!-- Apple -->
    <link rel="apple-touch-icon" href="https://codeonlyjs.org/codeonly-icon-256.png" />
    <!-- Meta Tags Generated via https://heymeta.com -->

    <link href="https://cdn.jsdelivr.net/gh/codeonlyjs/stylish@1.0.10/stylish.css" type="text/css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/gh/codeonlyjs/stylish@1.0.10/stylish-theme.min.js"></script>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/css.min.js"></script>
    <link id="hljs-theme" href="" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.52.0/min/vs/loader.js"></script>
    <script>
    require.config({ paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.52.0/min/vs' } });
    </script>
    <script>
    function updateHighlightTheme()
    {
        let el = document.getElementById("hljs-theme");
        let themeFile = stylish.darkMode ? "github-dark.min.css" : "github.min.css";
        let new_href = `https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/${themeFile}`;
        el.setAttribute("href", new_href);
    }
    stylish.addEventListener("darkModeChanged", updateHighlightTheme);
    updateHighlightTheme();
    </script>
    <style>
    :root
    {
        --dark-accent-color: #9D79E5;
    }
    :root.home-colors
    {
        --dark-body-back-color: #0a0b1a;
        --light-body-back-color: white;
    }
    body
    {
        padding: 0;
        margin: 0;
    }
    </style>
    <script type="module" crossorigin="crossorigin" src="/assets/index-CXDn6ClS.js"></script>
    <!--co-ssr-start--><link href="/assets/styles-AAABk3beHUc.css" type="text/css" rel="stylesheet" /><!--co-ssr-end-->
    <meta name="co-ssr" value="true" />
  </head>
  <body>
    <!--co-ssr-start-->
    <div id="layoutRoot">
      <header id="header">
        <a href="/" class="title"><img class="hide-sm" src="/public/codeonly-logo-light.svg" /><img class="hide-lg" src="/public/codeonly-icon.svg" /></a>
        <div class="buttons">
          <a href="/guide/" class="subtle button">Docs</a><a href="/lab" class="subtle button labLink vcenter"><svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 -960 960 960" preserveAspectRatio="xMidYMid slice" role="img"><path xmlns="http://www.w3.org/2000/svg" d="M200-120q-51 0-72.5-45.5T138-250l222-270v-240h-40q-17 0-28.5-11.5T280-800q0-17 11.5-28.5T320-840h320q17 0 28.5 11.5T680-800q0 17-11.5 28.5T640-760h-40v240l222 270q32 39 10.5 84.5T760-120H200Zm0-80h560L520-492v-268h-80v268L200-200Zm280-280Z"></path></svg> The Lab</a><input type="checkbox" class="theme-switch" />
          <script>
          document.querySelector(".theme-switch").checked = window.stylish.darkMode;
          </script>
        </div>
      </header>
      <div id="layoutDocumentation">
        <header id="mobile-bar"><button id="side-panel-menu-button" class="subtle muted"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 -960 960 960" preserveAspectRatio="xMidYMid slice" role="img"><path xmlns="http://www.w3.org/2000/svg" d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z"></path></svg> Menu</button><button id="side-panel-menu-button" class="subtle muted">On this page ›</button></header>
        <div id="div-wrapper">
          <div id="backdrop" class=""></div>
          <div id="div-lhs" class="">
            <nav id="nav-main">
              <!-- enter foreach block -->
              <h5> Introduction</h5>
              <ul>
                <!-- enter foreach block -->
                <li><a href="." class="">Welcome</a></li>
                <li><a href="start" class="">Getting Started</a></li>
                <!-- leave foreach block -->
              </ul>
              <h5> Components</h5>
              <ul>
                <!-- enter foreach block -->
                <li><a href="components" class="">Overview</a></li>
                <li><a href="component" class="">API</a></li>
                <!-- leave foreach block -->
              </ul>
              <h5> Templates</h5>
              <ul>
                <!-- enter foreach block -->
                <li><a href="templates" class="">Basics</a></li>
                <li><a href="templateText" class="">Text and HTML</a></li>
                <li><a href="templateHtmlElements" class="">HTML Elements</a></li>
                <li><a href="templateComponents" class="">Component References</a></li>
                <li><a href="templateIf" class="">If Directive</a></li>
                <li><a href="templateForEach" class="">ForEach Directive</a></li>
                <li><a href="templateEmbedSlots" class="">Embed Slots</a></li>
                <li><a href="templateInput" class="">Input Bindings</a></li>
                <li><a href="templateTransitions" class="">Transitions</a></li>
                <li><a href="templateFluent" class="">Fluent Templates</a></li>
                <li><a href="templateUpdateSemantics" class="">Update Semantics</a></li>
                <!-- leave foreach block -->
              </ul>
              <h5> Router</h5>
              <ul>
                <!-- enter foreach block -->
                <li><a href="routerBasics" class="">Basics</a></li>
                <li><a href="routerDetails" class="">Details</a></li>
                <li><a href="routerNotes" class="">Notes</a></li>
                <li><a href="routerTypical" class="">Typical Setup</a></li>
                <li><a href="router" class="">API</a></li>
                <!-- leave foreach block -->
              </ul>
              <h5> Rendering</h5>
              <ul>
                <!-- enter foreach block -->
                <li><a href="renderIntro" class="">Introduction</a></li>
                <li><a href="renderSSR" class="">Server Side Rendering (SSR)</a></li>
                <li><a href="renderSSG" class="">Static Site Generation (SSG)</a></li>
                <li><a href="renderStatic" class="">Static Rendering</a></li>
                <!-- leave foreach block -->
              </ul>
              <h5> Utilities</h5>
              <ul>
                <!-- enter foreach block -->
                <li><a href="utilities" class="">Utilities</a></li>
                <li><a href="Notify" class="">Notify Service</a></li>
                <!-- leave foreach block -->
              </ul>
              <h5> Related</h5>
              <ul>
                <!-- enter foreach block -->
                <li><a href="stylish" class="">Stylish CSS</a></li>
                <li><a href="bundle-free" class="">Bundle Free</a></li>
                <li><a href="cogent" class="">Cogent</a></li>
                <!-- leave foreach block -->
              </ul>
              <!-- leave foreach block -->
            </nav>
          </div>
          <div id="div-center">
            <div class="document-view">
              <h1>Router Notes</h1>
              <h2 id="not-found-page"><a class="hlink" href="#not-found-page">#</a>Not Found Page</h2>
              <p>To handle URL's not recognized by your app, you should register
a &quot;Not Found&quot; page.</p>
              <p>The following &quot;not found&quot; handler doesn't have a pattern (ie: it matches
anything) and the <code>order</code> property is set high enough to be matched
after all other routes have failed to match.</p>
              <pre><code class="hljs language-js">router.<span class="hljs-title function_">register</span>({
    <span class="hljs-attr">match</span>: <span class="hljs-function">(<span class="hljs-params">to</span>) =&gt;</span> {
        to.<span class="hljs-property">page</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NotFoundPage</span>(r.<span class="hljs-property">url</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    },
    <span class="hljs-attr">order</span>: <span class="hljs-number">1000</span>,
});
</code></pre>
              <h2 id="page-titles"><a class="hlink" href="#page-titles">#</a>Page Titles</h2>
              <p>The Router doesn't include any built in support for page titles
but it's pretty easy to build it yourself.</p>
              <p>Just have the route handler add a <code>title</code> property to the route when it
matches:</p>
              <pre><code class="hljs language-js">router.<span class="hljs-title function_">register</span>({
    <span class="hljs-attr">pattern</span>: <span class="hljs-string">&quot;/product/:productId&quot;</span>,
    <span class="hljs-attr">match</span>: <span class="hljs-function">(<span class="hljs-params">to</span>) =&gt;</span> {
        route.<span class="hljs-property">page</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProductPage</span>(route.<span class="hljs-property">match</span>.<span class="hljs-property">groups</span>.<span class="hljs-property">productId</span>);
        route.<span class="hljs-property">title</span> = <span class="hljs-string">`Product <span class="hljs-subst">${route.match.groups.productId}</span>`</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    },
});
</code></pre>
              <p>Update the <code>document.title</code> in your navigation handler:</p>
              <pre><code class="hljs language-js">router.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;didEnter&quot;</span>, <span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">from</span>, to</span>) =&gt;</span> {

    <span class="hljs-keyword">if</span> (to.<span class="hljs-property">page</span>)
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">routerSlot</span>.<span class="hljs-property">content</span> = router.<span class="hljs-property">current</span>.<span class="hljs-property">page</span>;

    <span class="hljs-comment">// Update document title</span>
    <span class="hljs-keyword">if</span> (to.<span class="hljs-property">title</span>)
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">`<span class="hljs-subst">${to.title}</span> - My CodeOnly Site`</span>;
    <span class="hljs-keyword">else</span>
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">&quot;My CodeOnly Site&quot;</span>;

});
</code></pre>
              <p>Now, visiting <code>/product/prod-123</code> will set the document title
of &quot;prod-123 - My CodeOnly Site&quot; and any routes that don't have a
title will display just the site name.</p>
              <div class="tip">
                <p>The above example synchronously sets the page title in the <code>match</code>
function.  If you need to make async data load requests to retrieve
the title you can do this by using an <code>async</code> version of <code>match</code>
or <code>mayEnter</code></p>
              </div>
              <h2 id="routes-to-modal-dialogs"><a class="hlink" href="#routes-to-modal-dialogs">#</a>Routes to Modal Dialogs</h2>
              <p>In addition to regular page navigation, the router can also be used
for routes that present as modal dialogs.</p>
              <p>Firstly, the <code>didEnter</code> function should create and show the modal dialog and
the <code>didLeave</code> method should close the dialog:</p>
              <pre><code class="hljs language-js">router.<span class="hljs-title function_">register</span>({
    <span class="hljs-attr">pattern</span>: <span class="hljs-string">&quot;/product-photo-popup/:productIdd&quot;</span>,
    <span class="hljs-attr">didEnter</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">from</span>, to</span>) =&gt;</span> {
        to.<span class="hljs-property">modal</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProductPhotoDialog</span>(r.<span class="hljs-property">match</span>.<span class="hljs-property">groups</span>.<span class="hljs-property">productId</span>);
        to.<span class="hljs-property">modal</span>.<span class="hljs-title function_">showModal</span>();
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    },
    <span class="hljs-attr">didLeave</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">from</span>, to</span>) =&gt;</span> {
        <span class="hljs-keyword">from</span>.<span class="hljs-property">modal</span>.<span class="hljs-title function_">close</span>();
    },
});
</code></pre>
              <p>Notice how the route handler doesn't set the <code>page</code> property on the
route. (Make sure your code that listens for router &quot;<code>didEnter</code>&quot; events
is prepared for this)</p>
              <p>As is, this will handle forward and back navigation to/from the dialog
however we need to also handle the case where the user explicitly closes
the dialog via a button or Escape key.</p>
              <p>Your dialog probably already has a <code>close</code> listener to remove the
dialog from the DOM when it's closed. At this point, we just check
if the current route refers to this dialog, and if so, tell the
router to navigate back:</p>
              <pre><code class="hljs language-js">    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dom</span>.<span class="hljs-property">rootNode</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;close&quot;</span>, <span class="hljs-function">() =&gt;</span> {

        <span class="hljs-comment">// If we&#x27;re the current router item this means</span>
        <span class="hljs-comment">// we were closed by the UI (escape key) and not</span>
        <span class="hljs-comment">// by navigating backwards.  Do the back navigation</span>
        <span class="hljs-comment">// now to go back to where we came.</span>
        <span class="hljs-keyword">if</span> (router.<span class="hljs-property">current</span>.<span class="hljs-property">modal</span> == <span class="hljs-variable language_">this</span>)
            router.<span class="hljs-title function_">back</span>();
</code></pre>
              <p>Note: if the initial page loaded by the app was the dialog, the <code>back</code>
function doesn't have anywhere to go back to.  The router detects this
case and instead navigates to the home page <code>/</code>.</p>
              <h2 id="out-of-app-links"><a class="hlink" href="#out-of-app-links">#</a>Out of App Links</h2>
              <p>When you click on a link in your site the router (or more specifically
the router driver) intercepts the click.  If the href of the link
looks like an internal page URL it initiates an in-app page load.</p>
              <p>If you have links that look like in-app links, but actually require
an external page load, you need to register a route handler that
matches those URLs and returns <code>null</code>.</p>
              <p>For example, suppose you needed to create a link an admin page at
<code>/admin</code> - but the admin page is implemented separately to your
app and needs a normal external page load, not an in-app page load.</p>
              <pre><code class="hljs language-js">router.<span class="hljs-title function_">register</span>({
    <span class="hljs-attr">pattern</span>: <span class="hljs-string">&quot;/admin&quot;</span>, 
    <span class="hljs-attr">match</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-literal">null</span>
});
</code></pre>
              <h2 id="centralized-routing-table"><a class="hlink" href="#centralized-routing-table">#</a>Centralized Routing Table</h2>
              <p>All the examples in this documentation show &quot;distributed&quot; route
registration where the route handlers live with the page that
handles the route.</p>
              <p>For most sites this is the preferred approach as it keeps
everything to do with a single page in one place.</p>
              <p>However if you have particularly complex routing requirements you
might find it easier to use a centralized approach where all the
routes are declared in one central routing table.</p>
              <p>All this requires is moving all the <code>router.register</code> calls into
a one central file.  And since the <code>register()</code> method accepts an
array of route handlers all the routes can be registered in a
single call:</p>
              <pre><code class="hljs language-js">router.<span class="hljs-title function_">register</span>([
    {
        <span class="hljs-attr">pattern</span>: <span class="hljs-string">&quot;/&quot;</span>,
        <span class="hljs-comment">// etc...</span>
    },
    {
        <span class="hljs-attr">pattern</span>: <span class="hljs-string">&quot;/about&quot;</span>,
        <span class="hljs-comment">// etc...</span>
    },
    {
        <span class="hljs-attr">pattern</span>: <span class="hljs-string">&quot;/admin&quot;</span>,
        <span class="hljs-comment">// etc...</span>
    },
    <span class="hljs-comment">// etc...</span>

])
</code></pre>
              <h2 id="page-caching"><a class="hlink" href="#page-caching">#</a>Page Caching</h2>
              <p>CodeOnly includes a page cache object that can be used to
re-use previosly created page objects.  This works particularly
well with back navigation to prevent previous pages from
having to reload data.</p>
              <p>To use the page cache first construct it, optionally passing
the maximum number of pages to keep cached (the default is 10
if not specified) as an options object:</p>
              <pre><code class="hljs language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> pageCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PageCache</span>({
    <span class="hljs-attr">max</span>: <span class="hljs-number">10</span>
});
</code></pre>
              <p>Then, instead of always constructing new page objects in your
route handlers, you can use the cache to retrieve a previous
instance or create a new one.</p>
              <pre><code class="hljs language-js">router.<span class="hljs-title function_">register</span>({
    <span class="hljs-attr">pattern</span>: <span class="hljs-string">&quot;/product/:productId&quot;</span>,
    <span class="hljs-attr">match</span>: <span class="hljs-function">(<span class="hljs-params">to</span>) =&gt;</span> {
        to.<span class="hljs-property">page</span> = pageCache.<span class="hljs-title function_">get</span>(
            to.<span class="hljs-property">url</span>, 
            <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResultsPage</span>(route.<span class="hljs-property">match</span>.<span class="hljs-property">groups</span>.<span class="hljs-property">productId</span>)
        );
    },
});
</code></pre>
              <p>The <code>PageCache.get</code> takes two parameters:</p>
              <ul>
                <li><code>key</code> - a key identifying the page to retrieve from the cache.  This
can be any value that can be compared with the JavaScript equality
operator (<code>==</code>).  If passed a URL object, the url's path and query are
concatenated to form the key.</li>
                <li><code>factory</code> - a callback to create a new page instance if the the existing
key can't be found in the cache.</li>
              </ul>
              <p>The page cache will keep up to the maximum count specified, discarding the
least recently used pages first.</p>
            </div>
            <nav class="next-previous-navigation"><a class="previous" href="routerDetails"><div class="description muted">‹ Previous</div><div class="title">Router Details</div></a><a class="next" href="routerTypical"><div class="description muted">Next ›</div><div class="title">Router Typical Setup</div></a></nav>
          </div>
          <div id="div-rhs" class="">
            <nav id="secondary-nav">
              <div class="highlight"></div>
              <a href="#" class="title">Router Notes</a>
              <ul class="h1">
                <!-- enter foreach block -->
                <li><a href="#not-found-page">Not Found Page</a><!-- IfBlock placeholder --></li>
                <li><a href="#page-titles">Page Titles</a><!-- IfBlock placeholder --></li>
                <li><a href="#routes-to-modal-dialogs">Routes to Modal Dialogs</a><!-- IfBlock placeholder --></li>
                <li><a href="#out-of-app-links">Out of App Links</a><!-- IfBlock placeholder --></li>
                <li><a href="#centralized-routing-table">Centralized Routing Table</a><!-- IfBlock placeholder --></li>
                <li><a href="#page-caching">Page Caching</a><!-- IfBlock placeholder --></li>
                <!-- leave foreach block -->
              </ul>
            </nav>
          </div>
        </div>
      </div>
    </div>
    <!--co-ssr-end-->
  </body>
</html>
